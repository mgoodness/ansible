---
# tasks file for ssh

- name: create configuration directory for current user
  file: >
    path={{ ssh_user_config_dir }}
    state=directory
    owner={{ username }}
    group={{ username }}
    mode=0750
  tags: ssh

- name: install SSH private keys for current user
  copy: >
    content="{{ item.private_key }}"
    dest={{ ssh_user_config_dir }}/{{ item.keyname }}
    owner={{ username }}
    group={{ username }}
    mode=0600
  with_items: ssh_keys
  tags: ssh

- name: install SSH public keys for current user
  copy: >
    content="{{ item.public_key }}"
    dest={{ ssh_user_config_dir }}/{{ item.keyname }}.pub
    owner={{ username }}
    group={{ username }}
    mode=0644
  with_items: ssh_keys
  tags: ssh
